<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reimbursement Portal</title>
  <script src="https://unpkg.com/pdf-lib"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 2rem; background-color: #f4f4f9; color: #333; }
    h1, h2, h3 { color: #2c3e50; }
    .hidden { display: none; }
    .form-section, .receipt-entry { margin-bottom: 1.5rem; padding: 1.5rem; border: 1px solid #ddd; border-radius: 8px; background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    label { display: block; margin-top: 1rem; font-weight: bold; color: #555; }
    input, select, textarea { width: 100%; padding: 0.75rem; margin-top: 0.3rem; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    button { background-color: #3498db; color: white; padding: 0.75rem 1.5rem; margin-top: 1rem; border: none; border-radius: 4px; cursor: pointer; font-size: 1rem; transition: background-color 0.3s; }
    button:hover { background-color: #2980b9; }
    button:disabled { background-color: #a9a9a9; cursor: not-allowed; }
    .radio-group label { display: inline-block; margin-right: 1rem; font-weight: normal; }
    .radio-group input { width: auto; margin-right: 0.5rem; }
    #referenceNumber { margin-top: 1rem; font-weight: bold; white-space: pre-line; padding: 1rem; border-radius: 4px; text-align: center; }
    #progressContainer { width: 100%; background-color: #e0e0e0; border-radius: 4px; margin-top: 1rem; overflow: hidden; }
    #progressBar { width: 0%; height: 24px; background-color: #3498db; border-radius: 4px; text-align: center; color: white; line-height: 24px; transition: width 0.4s ease; background-image: linear-gradient(45deg, rgba(255,255,255,.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,.15) 50%, rgba(255,255,255,.15) 75%, transparent 75%, transparent); background-size: 40px 40px; animation: progress-bar-stripes 2s linear infinite; }
    @keyframes progress-bar-stripes { from { background-position: 40px 0; } to { background-position: 0 0; } }
  </style>
</head>
<body>
  <h1>Reimbursement Portal</h1>
  <form id="reimbursementForm">
    <!-- simplified version just for demonstration -->
    <label>Full Name</label>
    <input type="text" name="fullName" required>

    <label>Email</label>
    <input type="email" name="email" required>

    <label>IBAN</label>
    <input type="text" name="iban" required>

    <button type="submit">Submit</button>
  </form>
  <div id="progressContainer" class="hidden"><div id="progressBar"></div></div>
  <div id="referenceNumber"></div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";

    document.getElementById('reimbursementForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const ref = 'REF' + Date.now();
      const form = e.target;
      const data = new FormData(form);
      const dataToSend = new URLSearchParams();

      for (const [key, value] of data.entries()) {
        dataToSend.append(key, value);
      }
      dataToSend.append("reference", ref);

      const referenceBox = document.getElementById('referenceNumber');
      const progressContainer = document.getElementById('progressContainer');
      progressContainer.classList.remove('hidden');
      document.getElementById('progressBar').style.width = '50%';
      referenceBox.innerText = 'Submitting...';

      try {
        const response = await fetch(SCRIPT_URL, {
          method: "POST",
          body: dataToSend
        });

        if (response.ok) {
          document.getElementById('progressBar').style.width = '100%';
          referenceBox.innerHTML = `✅ Submitted successfully!\nReference: ${ref}`;
          form.reset();
        } else {
          referenceBox.innerText = '❌ Submission failed. Please try again.';
        }
      } catch (err) {
        referenceBox.innerText = '❌ Network error. Please try again.';
      }

      setTimeout(() => {
        progressContainer.classList.add('hidden');
        document.getElementById('progressBar').style.width = '0%';
      }, 3000);
    });
  </script>
</body>
</html>
